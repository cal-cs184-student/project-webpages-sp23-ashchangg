<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>[CS 184] Project 3-2</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="e20d9fa6-4b20-47bb-9071-3ec5141758d4" class="page sans"><header><h1 class="page-title">[CS 184] Project 3-2</h1></header><div class="page-body"><h3 id="9374919f-d21f-4848-9450-450e44e00b98" class=""><strong>Ashley Chang, Dominic de Bettencourt </strong></h3><h2 id="ee04caa1-e529-4f85-be66-926628497dd3" class=""><mark class="highlight-yellow_background">Overview</mark></h2><p id="21e4a604-753a-4876-bb2d-a0ada4ec5778" class="">In this project, we extended our ray tracing algorithm from the previous project and added new features, such as the ability to render mirrors and glass, as well as the ability to modify depth of field. Our renderer can now render a wider variety of objects, and it can simulate reflection, refraction, and a changing camera aperture. We didn’t encounter a ton of issues with this part of the project, but when we did, our debugging process was generally to render an image at a low sample rate to see if we could diagnose the issue quickly. This allowed for us to fix the issues we had faster. </p><h2 id="aeb40a87-53ea-40d0-b37f-c65dc4191115" class=""><mark class="highlight-yellow_background"><strong>Part 1</strong></mark></h2><p id="616c5154-1eea-4b50-8308-3c7752429fe9" class=""><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Our Implementation:</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p><p id="dc537352-ee52-4f3a-a83e-f0d0319580c0" class="">In order to implement reflection, we applied a simple transformation of the incoming ray to calculate the outgoing ray. Then, we modified the <code>sample_f</code> function to call this <code>reflect</code> function. </p><p id="3269c05f-b21f-4f97-a25f-fd76da1bb53d" class="">Refraction was a little more complicated. We created a <code>refract</code> function which took an incoming ray and used Snell’s Law to calculate the resulting ray, making sure we had different cases for if the ray was entering or exiting the material. Additionally, it was important to ensure that if there was total internal reflection, we simply returned <code>false</code>.  We calculated the result ray using the equation:</p><figure id="3aa76465-6d40-4a78-b1c7-f04a435a3a99" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled.png"><img style="width:1140px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled.png"/></a></figure><p id="ab7c6612-863a-42e1-8294-27ab55ab4337" class="">
</p><p id="f2c85cc5-66d6-4eb9-8424-43513ab843b6" class="">After again updating the <code>sample_f</code> function, we had to combine both reflection and refraction. For this, we updated the <code>sample_f</code> function of <code>GlassBSDF</code> using Schlick’s approximation. We first checked if there was total internal reflection, and if there was, we only returned the reflection component. Otherwise, we computed Schlick’s reflection coefficient, and then with that probability, we computed the reflection component and returned that, and otherwise we computed the refraction component and returned that. In this way, we were able to get an approximation of the result of both reflection and refraction combined.</p><p id="8e96eb27-e9a3-4fd0-9e40-9bba218bd61e" class="">
</p><p id="26b96f98-4e31-41e4-8b55-b733007691ec" class=""><strong><strong>Spheres At Different Ray Depths</strong></strong></p><p id="7d88ee0f-959f-44bd-817d-df23f7fc7cf8" class=""><code>max_ray_depth = 0</code>: In this image, we see that only the light source is visible, which makes sense as the rays are not able to bounce off anything.</p><figure id="434acdc8-0a36-40dc-ae1c-fa60a93fda2f" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%201.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%201.png"/></a></figure><p id="b4313893-3098-4c11-b65e-564a68692d6d" class="">
</p><p id="19cc0ee9-8e3b-401f-a8f7-8e3526ab3260" class=""><code>max_ray_depth = 1:</code> In this image, we see that the walls and floor are illuminated, but the spheres are not yet fully illuminated, and the only light on them is the direct light from the light source.</p><figure id="2a274913-8c00-42f0-be7f-ba2bba37e6bc" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/CBspheres_writeup_maxr_1.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/CBspheres_writeup_maxr_1.png"/></a></figure><p id="9853063e-ff32-4e73-a1f2-2bca4dbdab65" class="">
</p><p id="f7467d4c-8bb4-4199-9590-485e99150228" class=""><code>max_ray_depth = 2:</code> In this image, we see that the left sphere has reflected the walls, as the additional bounce allows for more than just direct light. Additionally, the ceiling is now illuminated (though it is not seen as illuminated in the reflection in the left sphere).</p><p id="6d00fc56-9393-4b23-8953-17833d8b9084" class="">
</p><figure id="6be7c6d0-38d5-45c8-ba38-677bc44dad04" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/CBspheres_writeup_maxr_2.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/CBspheres_writeup_maxr_2.png"/></a></figure><p id="30e04658-c142-4484-8c4c-d50c6ec0fdda" class="">
</p><p id="2ec61794-1b1a-4f77-8a12-f26d870cb57c" class=""><code>max_ray_depth = 3:</code> In this image, we can notice that the right sphere is now brightly colored - the additional bounce allows more rays to reach the sphere and be visible. Additionally, the ceiling is now visible in the reflection from the left sphere, and there is now light under the right sphere.</p><p id="2e3c1f9b-dce4-4d68-9025-140543463af6" class="">
</p><figure id="6be49a8f-8c7c-44fe-a946-5fecdb7d02e7" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/CBspheres_writeup_maxr_3.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/CBspheres_writeup_maxr_3.png"/></a></figure><p id="e09338c3-b29a-4b9e-be1c-8ddb60aedc93" class="">
</p><p id="ea064629-ca53-443f-ba30-69319c1ee13e" class=""><code>max_ray_depth = 4:</code> In this image, we see only a small change from the previous image - now, the sphere in the reflection of the left sphere is blue instead of black. This additional bounce allows the light coming off of the right sphere after 3 bounces to be visible in the reflection.</p><p id="75deb4a5-650a-450e-bbc9-982791beefaa" class="">
</p><figure id="717f91d3-be6d-42ce-b9b7-a5d8c9221d1e" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%202.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%202.png"/></a></figure><p id="d95658be-9108-4da0-95ba-1137a9b5663e" class="">
</p><p id="364cd42a-0619-4b6a-af75-80770f16dcde" class=""><code>max_ray_depth = 5:</code> In this image, there is very little change from the previous. Most of the light can already be seen at 4 bounces, but the right sphere does appear to have a little more noise from random light interactions.</p><p id="37eaf450-7245-443d-abbf-8a4cc98dca9e" class="">
</p><figure id="3e9c68fc-ef6a-46f8-bbc0-c26149674035" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%203.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%203.png"/></a></figure><p id="300ea5ac-3e7d-4eef-b6c4-3ae7e83e840e" class="">
</p><p id="bf27ecb0-5334-4fc8-95bd-4512aed313d0" class=""><code>max_ray_depth = 100:</code> In this image, there again aren’t a lot of new changes, although the light at the top of the right sphere is now more spread out due to the refraction.</p><p id="a97b95c4-3365-43b8-929c-3b264385ac7e" class="">
</p><figure id="1209e855-7d37-41f5-85dd-19686cc7a238" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%204.png"><img style="width:480px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%204.png"/></a></figure><h2 id="69d00c25-e657-4cf6-8f5e-16ff9a299943" class=""><mark class="highlight-yellow_background"><strong>Part 4</strong></mark></h2><h3 id="0675dd3f-b9f9-4fad-9c17-d8db7ca60aab" class="">Pinhole vs Thin-Lens Camera Model</h3><p id="90873ff5-fe32-4dc7-b5b3-7e518851921c" class="">A pinhole camera model is a simple, camera with no lens and a tiny aperture (pinhole). In this case, everything is in focus. With a thin-lens camera, on the other hand, objects are only in focus if they are within a plane at a certain focal distance away from the lens. We can see how this plays out in the results below.</p><h3 id="2032e496-93b8-4684-a9dd-a44918c92573" class="">Approach</h3><figure id="0b29287c-4216-4f98-87b0-40f1374e3061" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%205.png"><img style="width:288px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%205.png"/></a><figcaption><em>Source: CS184 Course Material</em></figcaption></figure><p id="2aa7ac78-b5f2-495d-87e3-de43dfd9369a" class="">To implement the thin-lens camera model, we first uniformly sample the disk representing the thin lens at <code>pLens = Vector3D(lensRadius * sqrt(rndR) * cos(rndTheta), lensRadius * sqrt(rndR) * sin(rndTheta), 0)</code> . Next, we calculate pFocus by intersecting the plane of focus with the red segment (transform image coordinates to the lens in the same way as Project 3-1, and scale it appropriately <code>pFocus = Vector3D(x_coord * focalDistance, y_coord * focalDistance,-focalDistance)</code> ). Finally, we return a ray that has origin <code>pLens</code> (converted to world space) + <code>pos</code> and direction <code>pFocus</code> (normalized, and converted to world space), setting <code>min_t</code> and <code>max_t</code> to near and far clips.</p><h3 id="07416858-1317-4e64-b099-d07d78153234" class="">Results: “Focus Stack”</h3><p id="4dace38b-48b4-44ea-bc56-bf0c98bec098" class="">Below are results of rendering <code><em>CBdragon.dae</em></code><em> </em>at 4 different depths (<code>d</code> = 4.3, 4.5, 4.7, 4.9) with the following command <code><em>./pathtracer -t 8 -s 1024 -a 64 0.05 -r 640 480 -m 12 -l 4 -b 0.23 -d [chosen depth] ../dae/sky/CBdragon.dae</em></code><em>. </em>In the results, we can see that when we increase the focal distance, our output image focuses on sections at a further distance from the camera. For example, at <code>d = 4.3</code> our dragon is barely in focus but we can see that portions of the body closer to the camera (i.e. a small portion of the front foot) are in focus. On the other hand, at <code>d = 4.9</code> the output image is more focused on a further part of the dragon’s body (i.e. the tail).</p><div id="83655317-7b71-4520-be01-b5dfedfe8ca2" class="column-list"><div id="3a43bd78-b4a9-492a-a3da-bcda9a0c524c" style="width:50%" class="column"><figure id="3e175e43-8a8c-40cc-a54b-6bea19aee843" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_3.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_3.png"/></a><figcaption><code>d = 4.3</code></figcaption></figure></div><div id="a2b28866-6760-42de-943f-a4ca0d891b55" style="width:50%" class="column"><figure id="a108ff74-b170-40a0-aa7c-56303b852b70" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%206.png"><img style="width:283px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%206.png"/></a></figure></div></div><div id="c3c9d5e2-b0d4-4ec8-9df1-6244b94388cd" class="column-list"><div id="35e3fd8d-7665-40bf-9f1e-82e1a1f9e5e8" style="width:50%" class="column"><figure id="602f63c7-9c1e-49f4-94fe-60cd91bcabbc" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_5.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_5.png"/></a><figcaption><code>d = 4.5</code></figcaption></figure></div><div id="171e38ed-d07c-4965-a4f9-34b84e3f4952" style="width:50%" class="column"><figure id="93f28b8e-3e2b-4f2b-ae53-cb532d7a004c" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%207.png"><img style="width:281px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%207.png"/></a></figure></div></div><div id="28420fcc-c3d3-4280-b453-83d4302eb34b" class="column-list"><div id="e3a7855d-4237-403f-9af7-999a1c24fc7e" style="width:50%" class="column"><figure id="6af30978-baaf-4ada-b2cb-6fab2f0bb80e" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7.png"/></a><figcaption><code>d = 4.7</code></figcaption></figure></div><div id="1a54a9ac-71f4-4906-8614-2264eb1e58aa" style="width:50%" class="column"><figure id="4b456f94-19f6-4af9-bec7-65ae3482a6f4" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%208.png"><img style="width:280px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%208.png"/></a></figure></div></div><div id="5de3a9b6-8ec4-4f1e-a9f7-b065686fb096" class="column-list"><div id="60deeecf-e40e-45e1-836d-c5a7a1a36b93" style="width:50%" class="column"><figure id="d34307db-a710-409f-b9a2-b85b36ca5b1c" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_9.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_9.png"/></a><figcaption><code>d = 4.9</code></figcaption></figure></div><div id="6041645e-781a-482f-a032-703edf863c76" style="width:50%" class="column"><figure id="273802c6-70e4-4c13-a777-3107e9f8242e" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%209.png"><img style="width:278px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/Untitled%209.png"/></a></figure><p id="79492206-5474-441c-8208-97c21832d7fd" class="">
</p></div></div><h3 id="7e6a099e-5cc6-4e10-93c3-237465e29e4a" class="">Results: Aperture Adjustment</h3><p id="4a82dbc4-f5d8-4d1b-83ad-a21885ed2066" class="">Below are results of rendering <code><em>CBdragon.dae</em></code><em> </em>at 4 different apertures (<code>b</code> = 0.01, 0.1, 0.3, 0.5) with the following command <code><em>./pathtracer -t 8 -s 1024 -a 64 0.05 -r 640 480 -m 12 -l 4 -b [chosen aperture] -d 4.7 ../dae/sky/CBdragon.dae</em></code><em>. </em>In the results, we can see that when we increase <code>b</code>, the radius of what is in focus decreases (we get a blurrier background). This makes sense as aperture refers to the opening of a lens&#x27;s diaphragm through which light passes.<strong> </strong>A smaller <code>b</code> value corresponds to a narrower aperture and a deeper depth of field (our background will be more clear), and vice versa for a larger <code>b</code> value.</p><figure id="4f710f39-0532-4c2c-8978-7bc3ebbf557c" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/aperture-10.png"><img style="width:384px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/aperture-10.png"/></a><figcaption><em>Visualization of Aperture Size, Source: </em><em><a href="https://photographypro.com/aperture/">https://photographypro.com/aperture/</a></em></figcaption></figure><div id="cb25a061-c165-4291-ad06-9b2a15fc0a60" class="column-list"><div id="9d2a6795-1e4d-495d-a73a-97c0fd8d0480" style="width:50%" class="column"><figure id="224c2792-60e9-40ac-babb-70011cc84ada" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b01.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b01.png"/></a><figcaption><code>b = 0.01</code>, most of image in focus</figcaption></figure></div><div id="402585d1-efac-4f7c-b2d2-92d79ab27b18" style="width:50%" class="column"><figure id="bbb71fd7-394c-4e77-8b35-b4fde0906e24" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b1.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b1.png"/></a><figcaption> <code>b = 0.1</code>, slight blur in background</figcaption></figure></div></div><div id="bd799003-808e-444d-a900-fea509a1f039" class="column-list"><div id="5414fe4a-3158-4b41-9085-c1673c402f20" style="width:50%" class="column"><figure id="4ec97037-de05-4c67-98e4-b1d596d6eb71" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b3.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b3.png"/></a><figcaption><code>b = 0.3</code>, increased blur in background</figcaption></figure></div><div id="211fdfd1-ab3d-4bfa-80ae-12c003caf855" style="width:50%" class="column"><figure id="ddc9649a-7905-4abd-a4dd-3f17fccc1bb1" class="image"><a href="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b5.png"><img style="width:640px" src="%5BCS%20184%5D%20Project%203-2%20e20d9fa64b2047bb90713ec5141758d4/part4_d4_7_b5.png"/></a><figcaption><code>b = 0.5</code>, very visible blur in background</figcaption></figure></div></div><h2 id="2a46a8ea-b4b8-477c-b726-64d4d3652d6b" class=""><mark class="highlight-yellow_background">Conclusion</mark></h2><p id="8f1fa570-3b87-41c7-ad3c-4fef4ede79ca" class="">For Project 3-2, we worked through each section together just like our previous projects. Because the portions were less dependent on other code we’ve written, we ran into much fewer bugs than Project 3-1. Overall, we learned a lot about material modeling (glass and mirror) and how to implement rendering images from different depth of fields/apertures.</p><h3 id="93073f85-2eed-4361-8404-b39718b11fea" class=""><em><strong>Project Webpage</strong></em></h3><p id="8dcd1be3-83b1-48fd-9c85-e74e46c2f40d" class=""><a href="https://cal-cs184-student.github.io/project-webpages-sp23-ashchangg/proj3-2/index.html">https://cal-cs184-student.github.io/project-webpages-sp23-ashchangg/proj3-2/index.html</a></p><p id="6faadbfc-d122-488e-8b72-09363f1b4414" class="">
</p></div></article></body></html>